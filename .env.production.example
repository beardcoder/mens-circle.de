# ============================================
# Coolify v4 Environment Variables
# TYPO3 v13 + FrankenPHP Production Setup
# MINIMIZED VERSION - Only Required Variables
# ============================================

# ============================================
# Coolify Auto-Generated Variables
# These will be automatically set by Coolify
# ============================================

# SERVICE_FQDN_PHP_80=your-domain.com (auto-set by Coolify)
# SERVER_NAME will be auto-set from SERVICE_FQDN_PHP_80

# ============================================
# Database Configuration (REQUIRED)
# ============================================

DB_ROOT_PASSWORD=CHANGE_ME_STRONG_PASSWORD
DB_NAME=typo3
DB_HOST=db
DB_PORT=3306
DB_USER=typo3
DB_PASSWORD=CHANGE_ME_STRONG_PASSWORD
# Enable persistent DB connections for FrankenPHP (default: false)
DB_PERSISTENT=false

# ============================================
# Security (REQUIRED)
# ============================================

# JWT Secret for Newsletter tokens (min 32 chars)
# Generate with: openssl rand -base64 32
JWT_SECRET=CHANGE_ME_RANDOM_STRING_MIN_32_CHARS

# TYPO3 Install Tool Password
# ⚠️  IMPORTANT: The $ character in Argon2 hashes causes issues in Docker!
#
# Choose ONE of these 3 methods:

# METHOD 1: Plain-text password (RECOMMENDED for Coolify)
# Will be hashed automatically at runtime
INSTALL_TOOL_PASSWORD=your-strong-password

# METHOD 2: Base64-encoded hash (if plain-text doesn't work)
# Generate with:
#   HASH=$(php -r "echo password_hash('your-password', PASSWORD_ARGON2I);")
#   echo $HASH | base64
# INSTALL_TOOL_PASSWORD_BASE64=JGFyZ29uMmkkdj0xOSRtPTY1NTM2LHQ9MTYscD0xJA==

# METHOD 3: Pre-hashed with escaped $ (advanced, not recommended)
# You must escape $ as $$ in Coolify UI
# INSTALL_TOOL_PASSWORD_HASH=$$argon2i$$v=19$$m=65536,t=16,p=1$$HASH

# TYPO3 Encryption Key (96 chars hex)
# Generate with: openssl rand -hex 48
TYPO3_ENCRYPTION_KEY=CHANGE_ME_96_CHARS_HEX

# ============================================
# Mail Configuration (REQUIRED for production)
# ============================================

MAIL_TRANSPORT=smtp
MAIL_SMTP_SERVER=smtp.example.com:587
MAIL_SMTP_ENCRYPT=true
MAIL_SMTP_USERNAME=noreply@example.com
MAIL_SMTP_PASSWORD=CHANGE_ME
MAIL_SMTP_DOMAIN=example.com
MAIL_FROM_ADDRESS=noreply@example.com
MAIL_FROM_NAME=Mens Circle Niederbayern

# ============================================
# Redis Cache Configuration (RECOMMENDED)
# ============================================

REDIS_ENABLED=true
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=
# Enable persistent Redis connections for FrankenPHP (default: true)
REDIS_PERSISTENT=true
REDIS_TIMEOUT=2.5
REDIS_COMPRESSION_LEVEL=1

# Redis Cache Lifetimes (in seconds, 0 = unlimited)
REDIS_CACHE_PAGES_LIFETIME=604800
REDIS_CACHE_PAGES_COMPRESSION=true
REDIS_CACHE_PAGESECTION_LIFETIME=604800
REDIS_CACHE_HASH_LIFETIME=0
REDIS_CACHE_ROOTLINE_LIFETIME=0

# ============================================
# FrankenPHP Configuration
# ============================================

FRANKENPHP_ENABLED=true
# Enable APCu for runtime caches (requires APCu extension)
APCU_ENABLED=false

# Optional: FrankenPHP Worker Mode (3-4x better performance)
# FRANKENPHP_CONFIG=worker ./public/index.php

# ============================================
# Security & Performance
# ============================================

# Application environment (production, development, staging)
APP_ENV=production
# Trusted hosts pattern (regex, use .* for all or specific pattern)
TRUSTED_HOSTS_PATTERN=.*
# Development IP mask for debugging (empty for production)
DEV_IP_MASK=

# ============================================
# Debug & Logging (Production defaults)
# ============================================

DISPLAY_ERRORS=0
SQL_DEBUG=0
FE_DEBUG=0
BE_DEBUG=0
BE_LOCK_SSL=1

# Log file retention (days/weeks)
LOG_ERROR_MAX_FILES=7
LOG_CRITICAL_MAX_FILES=8

# ============================================
# Session Configuration
# ============================================

# Frontend session lifetime (in seconds, default: 86400 = 1 day)
FE_SESSION_LIFETIME=86400
# Backend session timeout (in seconds, default: 28800 = 8 hours)
BE_SESSION_TIMEOUT=28800

# ============================================
# HTTP Client Configuration
# ============================================

HTTP_TIMEOUT=30
HTTP_CONNECT_TIMEOUT=10

# ============================================
# Sentry Error Tracking (Optional)
# ============================================

SENTRY_TRACES_SAMPLE_RATE=1.0

# ============================================
# NOTE: The following are NOT needed anymore
# They use sensible defaults in the configuration
# ============================================

# ❌ REMOVED (hardcoded defaults):
# - TYPO3_DB_DRIVER=mysqli (always mysqli)
# - TYPO3_DB_HOST=db (Docker service name)
# - TYPO3_DB_PORT=3306 (standard MySQL port)
# - TYPO3_CACHE_REDIS_HOST=redis (Docker service name)
# - TYPO3_CACHE_REDIS_PORT=6379 (standard Redis port)
# - PHP_MEMORY_LIMIT=512M (set in Dockerfile)
# - PHP_OPCACHE_ENABLE=1 (set in Dockerfile)
# - PHP_DATE_TIMEZONE=Europe/Berlin (set in Dockerfile)
